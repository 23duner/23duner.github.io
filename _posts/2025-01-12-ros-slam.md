---
title: Sample Post
layout: post
post-image: "/blog_photo/slam.png"
description: 不会是职业生涯最大挑战之不会要被我跑通了吧
tags:
- sample
- post
- test
---
写！文！档！
某种程序员魔咒之：出个文档吧
cv的事，怎么能叫xx呢


---




\~/catkin\_ws/src/nav\_demo/目录下

统一roslaunch 功能包名称 launch文件名称 的方式启动

刷新环境

```bash
source ~/catkin_ws/devel/setup.bash
```



1. 小车启动文件car\_demo.launch

```bash
roslaunch nav_demo car_demo.launch
```

* 启动键盘控制节点

```bash
roslaunch nav_demo key.launch
```

机器人坐标系一般使用机器人模型中的根坐标系(base\_link 或 base\_footprint)，

里程计定位时，父级坐标系一般称之为 odom，

如果通过传感器定位，父级参考系一般称之为 map。

当二者结合使用时，map 和 odom 都是机器人模型根坐标系的父级，这是不符合坐标变换中"单继承"的原则的，所以，一般会将转换关系设置为: map -> odom -> base\_link 或 base\_footprint。

## 初始启动



查找占用 11311 端口的进程并关闭它：

使用 `netstat -tlnp` 命令可以查看当前系统中所有正在监听（`LISTEN` 状态）的 TCP 端口以及对应的进程信息，在终端中输入以下命令：



```bash
netstat -tlnp | grep 11311
```

会出现以下字段

```bash
tcp        0      0 0.0.0.0:11311           0.0.0.0:*               LISTEN      12345/your_process
```



其中 `12345` 就是占用 11311 端口的进程 PID，`your_process` 是对应的进程名称。然后可以使用 `kill` 命令来终止这个进程

```bash
sudo kill -9 12345
```

# 基于gmapping的slam建图

1. gmapping节点编写与启动

```bash
roslaunch nav_demo t1_slam.launch
```

启动后需添加rviz组件

Map&#x20;

本任务中需要保存的已经在/nav\_demo/rvizs/nav.rviz下了



* 保存地图

```bash
roslaunch nav_demo map_save.launch
```

可以通过修改map参数指向的value="$(find nav\_demo)/map/nav1路径来修改地图保存位置，保存多种地图

如修改为nav2 nav3

# 导航中的amcl定位

1. amcl节点的编写 见amcl.launch

2. amcl节点的运行 见test\_amcl.launch

```bash
roslaunch nav_demo test_amcl.launch
```

需要先加载全局地图:可以通过修改参数修改所加载的地图

然后启动 rviz 显示定位结果：可以通过修改参数修改加载的rviz配置，这里需要添加RobotModel、Map组件，分别显示机器人模型与地图，添加 posearray 插件，设置topic为particlecloud来显示 amcl 预估的当前机器人的位姿，箭头越是密集，说明当前机器人处于此位置的概率越高； 已经保存为/nav\_demo/rvizs/nav\_amcl.rviz

# 导航与路径规划

1. move\_base节点及其配置文件的编写

move\_base节点见path.launch

参数配置见catkin\_ws/src/nav\_demo/param



* 实现导航的集成文件nav.launch

```bash
roslaunch nav_demo nav.launch
```

同样需要启动相关rviz组件，这里的集成文件已经集成了nav\_path.rviz，包括全局代价地图与本地代价地图组件配置

* 通过Rviz工具栏的 2D Nav Goal设置目的地实现导航。

选择目的地即可



若小车出现问题 可以在rqt中动态参数调整

# 自主移动slam建图

无需启动键盘控制节点 ，启动下述节点后直接通过Rviz工具栏的 2D Nav Goal设置目的地实现边导航边建图

```bash
roslaunch nav_demo nav_auto.launch
```

这个launch文件中需要启动rviz&#x20;
